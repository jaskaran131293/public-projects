!function(i){i(document).ready(function(){function n(){i(".upload-custom-font").on("click",function(){var o=i(this).closest(".upload-font-block"),a=new wp.media({title:nbUpload.form_heading,multiple:!1,button:{text:nbUpload.button}});a.open();var l=[],c=[];a.on("select",function(){for(var n=a.state().get("selection").toJSON(),t=0;t<n.length;t++)l.push(n[t].url),c.push(n[t].title);var e=[];i.each(c,function(n,t){-1==i.inArray(t,e)&&e.push(t)}),1===e.length?(l.push(e),o.find(".display-custom-font").val(l[0]).trigger("change")):alert("An error occurred, please try again!")})})}function t(){var n=i(".customize-control-custom-font input[type=text]");n.on("change",function(){var e="";n.each(function(n,t){""!=i(this).val()&&("font_name"!=i(this).attr("name")||1==(i(this).val().match(new RegExp("fontName:","g"))||[].length).length?e+=i(this).val()+",":e+="fontName:"+i(this).val()+",")}),e=e.slice(0,-1),i(this).parents(".customize-control").find('input[type="hidden"]').val(e).trigger("change")})}function e(){i(".remove-font").on("click",function(){var n=i(this).data("index");upload_font_name=i(".upload-font-name[data-index="+n+"]"),upload_font_name.find("input:text").val("").trigger("change"),upload_font_name.remove(),clone_customfont_block=i(".clone-customfont-block[data-index="+n+"]"),clone_customfont_block.find("input:text").val("").trigger("change"),clone_customfont_block.remove(),i(this).remove(),i(".remove-font").length<=1&&i(".remove-font").hide()})}n(),t(),i(".remove-font").length<=1&&i(".remove-font").hide(),e(),i(".add-new-font").on("click",function(){data_index=i(".remove-font:last").data("index"),data_index_number=Number(data_index)+1,upload_font_name_new=i(".upload-font-name:last").last().clone(),upload_font_name_new.attr("data-index",data_index_number),upload_font_name_new.find("input:text").val("").end().appendTo(".clone-customfont"),clone_customfont_block_new=i(".clone-customfont-block:last").last().clone(),clone_customfont_block_new.attr("data-index",data_index_number),clone_customfont_block_new.find("input:text").val("").end().appendTo(".clone-customfont"),i(".remove-font:last").show(),i(".remove-font:last").last().clone().attr("data-index",data_index_number).appendTo(".clone-customfont"),n(),t(),e()})})}(jQuery);