{% if request.page_type == "product" %} 

{% assign product_id = product.id  %}
{% assign product_handle = product.handle  %}
{% assign collection = collections %}
    

{%- capture cfp_current_collection_list_prodPage -%}
{%- if collection -%}
{%- for getcollection in collection -%}  
    {%- for getproduct in getcollection.products -%}
    {%- if product_id == getproduct.id -%}    
{{getcollection.id | append: "," }}   
    {%- endif -%}
    {%- endfor -%}
{%- endfor -%}
{%- endif -%}
{%- endcapture -%}






{% else %}

{% assign cfp_current_collection_list_prodPage = "temp" %}

{% endif %}







{% assign custom = shop.metafields.call_for_price.Settings %}
{% assign btn_name=custom.callforprice_label %}
{% assign contact_no=custom.contact_no %} 
{% assign submit_btn_name=custom.submit %} 
{% assign hidePriceList=custom.hidePriceList %} 
{% assign hideaddtocart=custom.hideaddtocart %}
{% assign email=custom.email %}   
{% assign title=custom.title %}    
{% assign is_all_products=custom.is_all_products %} 
{% assign is_enabled=custom.is_enabled %} 
{% assign redirect_page=custom.redirect_url %} 
{% assign is_redirect=custom.is_redirect %}
{% assign country_enable=custom.country_enable %}
{% assign translate_fields = custom.translate_fields %} 
{% assign pay_status = custom.pay_status %} 
{% assign plan_name = custom.plan_name %} 
{% assign mail_chimp_enable = custom.mail_chimp_enable %} 
{% assign recaptcha_enable = custom.recaptcha_enable %}
{% assign variants_enable = custom.variants_enable %}




{% if shop.permanent_domain == "encorecabinetsdesign.myshopify.com" %}
{% render 'call-for-price-modal' %}
{% else %}
{% include 'call-for-price-modal' %}
{% endif %}



{% if is_enabled == "1" %}

<style>



{{hidePriceList}}{
display:none;
}

.cfp-prod-button{
display:none;
}

form[action="/cart/add"]{
/*  display:none;  */
}

.cfp-prod-handle, .cfp-prod-url, .cfp-prod-title , .cfp-prod-id
{

display:none; 

}




</style>




{% if plan_name == "cfp_plan_premium" and pay_status == "active" %} 
{% if recaptcha_enable == "1" %}

<script src="https://www.google.com/recaptcha/api.js?render={{custom.recaptchasite_key}}"></script>
<script>


grecaptcha.ready(function() {
// do request for recaptcha token
// response is promise with passed token
try{
grecaptcha.execute('{{custom.recaptchasite_key}}', {action:'validate_captcha'})
.then(function(token) {
// add token value to form
document.getElementById('g-recaptcha-response').value = token;
});
}
catch(err) {


}
});

</script>
{% endif %}
{% endif %}




<script>
  
  
  
  var nAgt = navigator.userAgent;
  checKGoogleBoat = false;
    //nAgt = 'AdsBot-Google (+http://www.google.com/adsbot.html)'
    function checkGoogleBoatAgent(nAgt){
      const robots = new RegExp([
        /bot/,/spider/,/crawl/,                            // GENERAL TERMS
        /APIs-Google/,/AdsBot/,/Googlebot/,                // GOOGLE ROBOTS
        /mediapartners/,/Google Favicon/,
        /FeedFetcher/,/Google-Read-Aloud/,
        /DuplexWeb-Google/,/googleweblight/,
        /bing/,/yandex/,/baidu/,/duckduck/,/yahoo/,        // OTHER ENGINES
        /ecosia/,/ia_archiver/,        
        /semrush/,                                         // OTHER
      ].map((r) => r.source).join("|"),"i");               // BUILD REGEXP + "i" FLAG

      return robots.test(nAgt);
    };

    
    checKGoogleBoat = checkGoogleBoatAgent(nAgt);
    
    if(nAgt.indexOf('www.google.com') != -1){
        checKGoogleBoat = true;
    }

    if(!checKGoogleBoat){

/* app code */

if (typeof time_for_shop == 'undefined')   time_for_shop = 1000;  //for settimeout method
if (typeof additional_hide_element == 'undefined')   additional_hide_element = "";  //for hiding complex theme element
if (typeof hide_cfp_modal_sec == 'undefined')   hide_cfp_modal_sec = 3000; 









var loadScript = function (url, callback) {
var script = document.createElement('script');
script.type = 'text/javascript';
if (script.readyState) {
script.onreadystatechange = function () {
if (script.readyState == 'loaded' || script.readyState == 'complete') {
script.onreadystatechange = null;
callback();
}
};
} else {
script.onload = function () {
callback();
};
}
script.src = url;
document.getElementsByTagName('head') [0].appendChild(script);
};

if ((typeof jQuery === 'undefined') || (parseFloat(jQuery.fn.jquery) < 1.7)) {
loadScript('//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js', function () {
jQuery191 = jQuery.noConflict(true);
myAppJavaScript(jQuery191);
});
} else {
myAppJavaScript(jQuery);
}


function myAppJavaScript($) {
 






var Create_form_fields=(productdata)=>
{


var options=productdata.product.options;


for(let i = 0; i < options.length; i++){

var varianName=options[i].name;
var varianValuesArray=options[i].values;

// select_id=`cfp_sel_${varianName}`;
select_id=varianName;
select_id = select_id.replace("(", "");
select_id = select_id.replace(")", "");
// select_id=select_id.replaceAll(" ","_");

select_id=select_id.replace(/\s/g,"");
select_id=select_id.replace(/\//g,"");
select_id=select_id.replace(/&/g,"and"); 
select_id=select_id.replace(/:/g,""); 
select_id=select_id.replace(/-/g,""); 
select_id=select_id.replace(/=/g,""); 


var variant_class = "cfp_var"+i;



//  select_id=select_id.replaceAll("/","-");

if(varianName=="Title") 
{
continue;

}

Select_keyword_placeholder = "Select"; 
if(Shopify.shop=="shoopsschweiz.myshopify.com") { Select_keyword_placeholder=""; }

SelectDiv=`<div class="form-group">
<select class="form-control formfield  cfp_var_data ${variant_class}" id=${select_id} name="cfp_var['var']['${varianName}']"><option selected="true" value="select_default_opt" disabled="disabled" >
${Select_keyword_placeholder} ${varianName}</option></select></div>`;   //created dynamic select option

$('.cfp_variants').prepend(SelectDiv);
var options_html=  varianValuesArray.forEach(Create_selectmenu); 







function Create_selectmenu(item) {

var options='<option value="'+item+'">'+item+'</option>'; 
//created dynamic options for select menu
$('#'+select_id).append(options); 





} 


}

}



name_vald=`{{translate_fields.name_vald}}`  
email_blank_vald=`{{translate_fields.email_blank_vald}}`
email_invalid_vald=`{{translate_fields.email_invalid_vald}}`
message_vald=`{{translate_fields.message_vald}}`
phone_blank_vald=`{{translate_fields.phone_blank_vald}}`
phone_cc_vald=`{{translate_fields.phone_cc_vald}}`
country_vald=`{{translate_fields.country_vald}}`
success_message=`{{custom.form_success_message}}`
variant_blank_vald=`{{translate_fields.variant_form_field_msg}}`
image_vald=`{{translate_fields.image_vald}}`
variants_enable=`{{variants_enable}}`;


is_all_products = "{{is_all_products}}";
hidePriceList = `{{hidePriceList}}`
enable="{{is_enabled}}";



/* code if premium plan the show checkbox for user for subscription*/


pay_status="{{pay_status}}"
plan_name="{{plan_name}}"
mail_chimp_enable="{{mail_chimp_enable}}"


if(pay_status=="active" && plan_name =="cfp_plan_premium" )
{

if(mail_chimp_enable=="1")
{
$('.cfp_subscribe_wrapper').show();
}
}

else
{  
$('.cfp_subscribe_wrapper').hide();  
}
  
shop=Shopify.shop; 
if(is_all_products == "1"){
$(hidePriceList).hide()
}


  
  
    
      
      if($('.cfp-prod-wrapper').length > 0){
  
      $(".cfp-prod-wrapper").each(function(){
                                  
                                      
                                   
                                  
var currel = $(this);   
var currhndle = currel.find(".cfp-prod-handle").text();
var currID = currel.find(".cfp-prod-id").text();  
                                  

var current_collection_list_values =  currel.attr("data-collection-list");
        
        
        
 var current_collection_list = current_collection_list_values.split(",");     
 var cfp_total_collection_list_values  = `{{custom.cfp_collection_Ids}}`
 var cfp_total_collection_list  = cfp_total_collection_list_values.split(",");
                                  
                               var cfp_product_on = false;   
                                  for (collection_name of cfp_total_collection_list) {
                                  for (current_collection of current_collection_list) {
                                    
                            if(current_collection.length >= 2 && collection_name.length >= 2) {           
                              if(current_collection==collection_name) {    cfp_product_on=true;}     }} }
      
        if(currel.attr("data-product-status")=="yes" || is_all_products == "1") {   cfp_product_on=true; }  
         
                                  
                                    if(cfp_product_on){
console.log("COLL_ENABLE");
if(shop == 'stuke-shop.myshopify.com'){
currhndle=checkTranslateHandle();
}


currel.find(".cfp-prod-button").show();
currel.parent().find(hidePriceList).remove()


if(shop == 'butchers-sundries-kbx.myshopify.com' ){
$(this).parent().find('form[action="/cart/add"]').hide();
}

else if(shop == 'myartph.myshopify.com'){

$(this).prev().prev().find('form').hide();

}



else if( shop=='cbonart.myshopify.com'){ $(this).prev().remove()  } 



else if( shop == 'spectrapure.myshopify.com'){ $(this).prev().find('form').remove()  } 

else if(shop == 'lfxjewelryny.myshopify.com')
{

$(this).prev().prev().prev().remove();

}
  
                                
                                  }
                                  else{      
                                    if(currel.attr("data-cfp_checked")!=="done")  { currel.find(".cfp-prod-button").hide(); }                                 

currel.parent().find(hidePriceList).show()
var hidepriceArray = hidePriceList.split(",");
for (price_item of hidepriceArray )
{
var price_item_array = price_item.split(" ");
currel.parent().find(price_item_array[price_item_array.length-1]).show()
}


if(shop=="luxury-designers-com.myshopify.com")
{currel.parent().show()

}

}
});
                              
                            
           
           
         
         
       
      
      
    }
  else
  {
    if (window.location.pathname.indexOf('/products/') !== -1) {

}else{
$(hidePriceList).show();
}
  }  

  
  if (window.location.pathname.indexOf('/products/') !== -1) {   //startproduct

    
    
    var current_collection_list_values_prodPage =  `{{cfp_current_collection_list_prodPage}}`;
    var current_collection_list_prodPage = current_collection_list_values_prodPage.split(",");     
  var cfp_total_collection_list_values_prodPage  = `{{custom.cfp_collection_Ids}}`
  var cfp_total_collection_list_prodPage  = cfp_total_collection_list_values_prodPage.split(",");
    
    
    var cfp_enabled = "no"; 
    cfp_enabled = `{{product.metafields.call_for_price_app.cfp_status}}`;
                                  for (collection_name of cfp_total_collection_list_prodPage) {
                                  for (current_collection of current_collection_list_prodPage) {
                                    
                            if(current_collection.length >= 2 && collection_name.length >= 2) {           
                              if(current_collection==collection_name) {     cfp_enabled="yes";}     }} }
                        
      if(is_all_products == "1") {     cfp_enabled="yes";}
                             if(cfp_enabled=="yes"){
                               
curr_url_detailpge = "{{product.url}}";
curr_title_detailpge = "{{product.title| replace: '"', "'" }}";
curr_hundle_detailpge = "{{product.handle}}";
curr_hundle_pid = "{{product.id}}";

if(Shopify.shop == "lacava-specialty-coffee-roastery.myshopify.com"){    
addtocfpbutton = '<div class="cfp-prod-wrapper-detail">'+
'<div class="cfp-prod-url">'+curr_url_detailpge+'</div>'+
'<div class="cfp-prod-id">'+curr_hundle_pid+'</div>'+
'<div class="cfp-prod-title">'+curr_title_detailpge+'</div>'+
'<div class="cfp-prod-handle">'+curr_hundle_detailpge+'</div>'+
'<div class="cfp-prod-button">'+
'<button type="button" class=" btn Button Button--primary button button--primary call-for-price-btn  Form__Submit Button Button--primary Button--full ">{{btn_name}}</button>'+
'</div>'+
'</div>';            

}
else
{

addtocfpbutton = '<div class="cfp-prod-wrapper-detail">'+
'<div class="cfp-prod-url">'+curr_url_detailpge+'</div>'+
'<div class="cfp-prod-id">'+curr_hundle_pid+'</div>'+
'<div class="cfp-prod-title">'+curr_title_detailpge+'</div>'+
'<div class="cfp-prod-handle">'+curr_hundle_detailpge+'</div>'+
'<div class="cfp-prod-button">'+
'<button type="button" class="btn Button Button--primary button btn-primary button--primary call-for-price-btn ">{{btn_name}}</button>'+
'</div>'+
'</div>';  
}



  $( "form" ).each(function( index ) {
getForm=false;    
 if (typeof $(this).attr("action") !== "undefined") {   
getForm = $(this).attr("action").includes("/cart/add");
    if (typeof getForm == "undefined") {   
  getForm=false;  
}
 }


if(getForm == true){
  
  
console.log("func");
$(hidePriceList).remove()

if(Shopify.shop == "pro-stock-tennis.myshopify.com"){



$(this).find("#AddToCart--product-template").before(addtocfpbutton);
$('.cfp-prod-button,form[action="/cart/add"]').show();
$(this).find("#AddToCart--product-template").remove()
$(this).find(".shopify-payment-button").remove();
}
  
  



else if(Shopify.shop=="elnumerouno.myshopify.com"){


$('.product-details').after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).hide();
}

else if(Shopify.shop=="raghavendra-rathore-jodhpur.myshopify.com"){

$('.inventory-product-row-product-template').hide();  // for raghavendra store

$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).remove()


}
          else if(Shopify.shop=="m-gebauer.myshopify.com")

                 { 
                   
                        $(".ProductForm__BuyButtons").after(addtocfpbutton);
                      $(".cfp-prod-button").show();   
               $(".ProductMeta__Price, .ProductForm__BuyButtons, .total_div, .ProductForm__QuantitySelector").hide();   
                   }
  
  else if(Shopify.shop=="makoba-pens.myshopify.com"){
    if($('.cfp-prod-wrapper-detail').length == 0){  
    
$(this).after(addtocfpbutton);
$('.sticky-item').html();
$(".sticky_form").hide();    
$(".cfp-prod-button").show();  
      
    }
    
    
  }
  
  


else if(Shopify.shop=="gentrys-bbq.myshopify.com"){



$(this).find('.product-page-qty').after(addtocfpbutton);   
$('.desc_blk_bot .qty').remove();  
$(".cfp-prod-button").show();  

}

else if(Shopify.shop=="robs-furniture-mattresses.myshopify.com"){  



$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(".variations, .desc_blk_bot").remove();    

}

else if(Shopify.shop=="smits-ladders.myshopify.com"){  



$('.product-single__description').before(addtocfpbutton);
$(".cfp-prod-button").show();
$(".product-form,product-form-product-template").remove();   

}  

else if(Shopify.shop == "musecontemporary.myshopify.com"){    

// $('.cfp-prod-button,form[action="/cart/add"]').show();
$(".product__quantity").remove()
$(".add-to-cart").remove();
$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
}
else if(Shopify.shop == "hayanehdiya.myshopify.com"){   

$(this).after(addtocfpbutton);
//                         $('form[action="/cart/add"]').remove();
$(".cfp-prod-button").show();
$(this).remove()
//  $(this).hide();

}
             
else if(Shopify.shop == "no-42-interiors.myshopify.com"){   

$(this).before(addtocfpbutton);
$(".cfp-prod-button").show();
// $(this).remove()
$(this).find('.engoj-btn-addtocart,.selector-wrapper,.maxus-productdetail__options,.qty-cart').remove();
$(hidePriceList).remove()

}      
else if(Shopify.shop == "partyplannerno.myshopify.com"){   
$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).find('.product-form--smart-payment-buttons,.product-form--button-container').hide();
$('.product-form--variants').show();

}   
else if(Shopify.shop == "lfxjewelryny.myshopify.com"){   
$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(".payment-and-quantity").hide();
//$(this).find('.payment-and-quantity__add,.payment-button').hide();
} 

else if(Shopify.shop == "saferplace-market.myshopify.com")
{

$(hidePriceList).remove();
  
  
$(this).find('.product-details').find('.product-actions').after(addtocfpbutton);
$(this).find('.product-details').find('.product-actions').remove();
$(".cfp-prod-button").show();
}


else if(Shopify.shop == "eye-lures.myshopify.com")
{


$('.description').after(addtocfpbutton);
$('.shopify-payment-button').hide();
$(".cfp-prod-button").show();
}
else if(Shopify.shop == "minnesota-hot-tubs.myshopify.com")
{


$(this).before(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).show()
}

else if(Shopify.shop == "vik-jethwani-2.myshopify.com"){

$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$('.product__submit__item').hide();

}

else if(Shopify.shop == "luxury-designers-com.myshopify.com"){

$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).hide();

}
else if(Shopify.shop == "boboli-ca.myshopify.com"){

addtocfpbutton = '<div class="cfp-prod-wrapper-detail">'+
'<div class="cfp-prod-url">'+curr_url_detailpge+'</div>'+
'<div class="cfp-prod-id">'+curr_hundle_pid+'</div>'+
'<div class="cfp-prod-title">'+curr_title_detailpge+'</div>'+
'<div class="cfp-prod-handle">'+curr_hundle_detailpge+'</div>'+
'<div class="cfp-prod-button">'+
'<button type="button" class="btn button Button Button--primary button--primary call-for-price-btn ">{{btn_name}}</button>'+
'</div>'+
'</div>';  

$(".ProductForm__BuyButtons").before(addtocfpbutton);
$(".cfp-prod-button").show();
$(".ProductForm__BuyButtons").hide();

}

else if(Shopify.shop == "delli-clean.myshopify.com"){

$(hidePriceList).remove()

// return false;
$(".product-single__meta  .product__policies").hide();
$(".payment-buttons").find("button").hide()
$('.shopify-payment-button').hide();
$(this).before(addtocfpbutton);
$(".cfp-prod-button").show();  
}
  
else if(Shopify.shop == "bermar-servizi.myshopify.com" )
  {
$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).hide();
  }
  
  
                  else if(Shopify.shop=="makoba-pens.myshopify.com"){
                    if($('.cfp-prod-wrapper-detail').length == 0){  

                      $(this).after(addtocfpbutton);
                      $('.sticky-item').html();
                      $(".sticky_form").hide();    
                      $(".cfp-prod-button").show();  

                    }


                  } 
  
                  else if(Shopify.shop=="encorecabinetsdesign.myshopify.com"){   
                    
                    console.log("called");
                    if($('.cfp-prod-wrapper-detail').length == 0){  

                      $(".product-smart-wrapper").after(addtocfpbutton);
                      
                      
            $(".cfp-prod-button").show();  
                    }
                  } 


  

else{

$(this).after(addtocfpbutton);
$(".cfp-prod-button").show();
$(this).remove();
$(this).hide();



}


}
});
                                                         

                               
                              

                            }   
                              else
                              {
                                
                              $('form[action="/cart/add"]').show();
                              $(hidePriceList).show()
                                
                              }
                              
                            
  
  } //endproduct










$(document).on('click', '.call-for-price-btn', function (e) {

$('.cfp-parent-wrapper').css("opacity","0");
$('.cfp_loader').css("display","block");
$('.text-danger').hide();


var country_enable = "{{country_enable}}";  

var country_field  = (country_enable=="1") ?  $('.cfp_country_field').show()  : $('.cfp_country_field').hide()   ;


// $('.sb_cfp')[0].reset();
//  document.getElementsByClassName("sb_cfp").reset();
$('.formfield').val('');
$('.cfp_variants').empty();  //remove appended field for fresh start
var url = window.location.href;


$('#cfpmodal').css("display","block");

//shop=window.location.hostname;
shop_for_products=Shopify.shop;  // url for ajax products variant getting process
shop=Shopify.shop;    

if(shop_for_products == "musecontemporary.myshopify.com") {  shop_for_products = "musecontemporary.com" } 
if(shop_for_products == "partyplannerno.myshopify.com") {  shop_for_products = "party-planner.no" }
if(shop_for_products == "spobu-resistors-draft2.myshopify.com") {  shop_for_products = "www.spobu-resistors.com" }  

if(shop!="nb-teamsports.myshopify.com")
{
$('.cfp_team_name_wrapper').hide();
}

var product= $(this).parent().parent().find('.cfp-prod-url').html();
title= $(this).parent().parent().find('.cfp-prod-title').html();

$('#cfp_product_name').html(title);

productid= $(this).parent().parent().find('.cfp-prod-id').html();

producthandle=$(this).parent().parent().find('.cfp-prod-handle').text();


producturl=location.hostname+product;

// alert(producthandle);

AjaxURL = 'https://'+shop_for_products+'/products/'+producthandle+'.json';

// alert(AjaxURL);

var request = $.ajax({
url:AjaxURL,
type: "GET",

dataType: "json",
beforeSend: function() {

$('.cfp_loader').css("opacity","1");
},
});

request.done(function(productdata) {




var myJSON = JSON.stringify(productdata);

productdata=JSON.parse(myJSON);

if(variants_enable=="1")
{
Create_form_fields(productdata);
}

//  alert("after");
$('.cfp_loader').css("display","none");
$('.cfp-parent-wrapper').css("opacity","1");

});

request.fail(function(productdata) {


$('.cfp_loader').css("display","none");
$('.cfp-parent-wrapper').css("opacity","1");

});




var  translate_fields= {{translate_fields | json}};


$('#cfpname').attr('placeholder',translate_fields.placeholder_name);
$('#cfpemail').attr('placeholder',translate_fields.placeholder_email);
$('#cfpphone').attr('placeholder',translate_fields.placeholder_phone);
$('#cfp_country').attr('placeholder',translate_fields.select_country);
$('#cfpmessage').attr('placeholder',translate_fields.placeholder_your_msg);
$('#country_first_option').text(translate_fields.select_country);   




{% if customer %}  // auto fill form fileds if customer is logged in
var cfp_customer_full_name="{{customer.name}}";
var cfp_customer_email="{{customer.email}}";
$('#cfpname').val(cfp_customer_full_name); $('#cfpemail').val(cfp_customer_email);
{% endif %}





});


var span = document.getElementsByClassName("close")[0];
// span.onclick = function() {
$(document).on('click', '.close', function(){
$('#cfpmodal').css("display","none");
});





$(document).on('click', '.submitReq', function(){    




$('.text-danger').remove();  
var email_regex = /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
var name1 = $('#cfpname').val();  



var email = $('#cfpemail').val();  


if( $( "#cfpphone" ).length ) {  var phone = $('#cfpphone').val(); 

phone=phone.replace(/ /g,'')
var countrycode_val = phone.match(/^\+\d{1,3}\d{9,15}$/);

}

if( $( "#cfpmessage" ).length ) {   var message = $('#cfpmessage').val(); }
if( $( "#cfp_country" ).length ) {  var country = $('#cfp_country').val();  }
var cfp_team_name = $('#cfp_team_name').val();
var ownermail="{{email}}";
var cfp_file =  $("#cfp_image").val();








var gcaptcha=$('.g-recaptcha-response').val();









var var_Array=$('.cfp_var_data');



var VariantsArray=new Array();



for(var i = 0; i < var_Array.length; i++){
var Var_name=$(var_Array[i]).attr('id');
var Var_value=$(var_Array[i]).val();
var var_collection = {
'Var_name' : Var_name,
'Var_value' : Var_value
};

VariantsArray.push( var_collection );
}










var jObject={};
jObject = JSON.stringify(VariantsArray);


if(!VariantsArray)
{
// VariantsArray="abcd";
}





/* validation controllers*/

required_form_fields = "{{custom.required_form_fields}}";







count_name = true;  
if (name1.length==0) {
$('#cfpname').after(`<span class=\'err_name text-danger\'>${name_vald}</span>`);
count_name = false;
} 
if (email.length == 0) {
$('#cfpemail').after(`<span class=\'err_email text-danger\'>${email_blank_vald}</span>`);
count_name = false;
} 
else
{
if(!email_regex.test(email)){
$('#cfpemail').after(`<span class=\'err_msg text-danger\'>${email_invalid_vald}</span>`);

count_name = false;
}
}



if(required_form_fields.includes("message")){
if (message.length ==0 ) {
$('#cfpmessage').after(`<span class=\'err_msg text-danger\'>${message_vald}</span>`);  

count_name = false;  
}
}

if(required_form_fields.includes("phone")){






if (phone.length <= 9) {
$('#cfpphone').after(`<span class=\'err_phone text-danger\'>${phone_blank_vald}</span>`);
count_name = false;
} else if(!countrycode_val)
{
  
  var country_code_vald_hide_shops =["rp-imaging.myshopify.com","flooring-for-less-online.myshopify.com","pessoa-joias.myshopify.com","jessica-flinn-designs.myshopify.com","no-42-interiors.myshopify.com","high-tech-delivery.myshopify.com","i-dance-contemporary.myshopify.com","bohl-companies.myshopify.com","spread-event-co.myshopify.com","joombo-co.myshopify.com","portabo.myshopify.com","production-case.myshopify.com","w-rltd.myshopify.com","robs-furniture-mattresses.myshopify.com","myartph.myshopify.com"];    
if($.inArray(shop, country_code_vald_hide_shops) == -1)  // if shop is not present in array only then validate for mobile field
{
$('#cfpphone').after(`<span class=\'err_phone text-danger\'>${phone_cc_vald}</span>`);
count_name = false;
}
}



}




if(required_form_fields.includes("country")) 
{  

if(!country)
{
$('#cfp_country').after(`<span class=\'err_msg text-danger\'>${country_vald}</span>`);
count_name = false;
}


}

if(Shopify.shop=='lacava-specialty-coffee-roastery.myshopify.com')
{

count_name = true;

}


if(required_form_fields.includes("variants")) 
{  

var variants_validation = [".cfp_var0",".cfp_var1",".cfp_var2"];  
for (variant_vald of variants_validation) {

if($(variant_vald).length > 0){
var variant_value =  $(variant_vald).val();

if(variant_value == null){
$(variant_vald).after();
cvarian_vald="abcd";
$(variant_vald).after(`<span class=\'err_msg text-danger\'>${variant_blank_vald}</span>`);
count_name=false;
}

}

}
}

if(required_form_fields.includes("image")) 
{  

if(!cfp_file)
{
$('#cfp_image').after(`<span class=\'err_phone text-danger\'>${image_vald}</span>`);
count_name=false;
}



}

if(Shopify.shop=="spobu-resistors-draft2.myshopify.com")  //cfp_adt_flds
{
var farma = $('#addt_farma').val();
var farma_blank_vald = "Bitte Ausf√ºllen";
if (farma.length == 0) {
$('#addt_farma').after(`<span class=\'err_msg text-danger\'>${farma_blank_vald}</span>`);
count_name = false;  
}

if ($("#cfp_subscribe").is(
":checked")) {
} else {
var policy_vald ="Bitte stimmen Sie unseren Datenschutzrichtlinien zu";
$('.cfp_nwsltr').after(`<span class=\'err_msg text-danger\'>${policy_vald}</span>`);   
count_name = false;
}

}



if(count_name){

var cfp_form = $('.sb_cfp ')[0]; 
var cfo_form__data = new FormData(cfp_form);
cfo_form__data.append('name', name1);
cfo_form__data.append('email', email);
cfo_form__data.append('phone', phone);
cfo_form__data.append('message', message);
cfo_form__data.append('pid', producturl);
cfo_form__data.append('productid', productid);
cfo_form__data.append('message', message);
cfo_form__data.append('shop', shop);
cfo_form__data.append('senderemail', ownermail);
cfo_form__data.append('country', country);
cfo_form__data.append('cfp_team_name', cfp_team_name);
cfo_form__data.append('gcaptcha', gcaptcha);
cfo_form__data.append('VariantsArray', VariantsArray);
cfo_form__data.append('title', title);      
var cfp_allowed_files = ["png","jpeg","jpg","gif","csv","pdf","docs","doc"];

/* if( $('#cfp_image').length){ 
var cfp_image_length = document.getElementById('cfp_image').files.length;
for (var x = 0; x < cfp_image_length; x++) {
cfo_form__data.append("cfp_file[]", document.getElementById('cfp_image').files[x]);
}  

} */

if( $('#cfp_image').length){ 
var cfp_image_length = document.getElementById('cfp_image').files.length;

for (var x = 0; x < cfp_image_length; x++) {
var inq_image = document.getElementById('cfp_image').files[x];

var cfp_fle_extension = inq_image['name'].split('.').pop();
if(cfp_allowed_files.includes(cfp_fle_extension.toLowerCase()))
{
cfo_form__data.append("cfp_file[]", document.getElementById('cfp_image').files[x]);
}
else
{
$('#cfp_image').after(`<span class=\'err_phone text-danger\'>${image_vald}</span>`);
return false;
}

}  

}

if($("#cfp_subscribe").length)
{

if ($('#cfp_subscribe').is(':checked')) {
cfo_form__data.append('customer_subscribe', "1");

}

}







$.ajax({
url: 'https://setubridgeapps.com/call-for-price/app/src/public/submitreq_new',   
/*   method: 'POST',  */
type: 'POST',  
data: cfo_form__data,
processData: false,
contentType: false,
cache: false,
beforeSend: function() {
$('.cfp_loader').css("display","block");                            
$('.cfp_loader').css("opacity","1");
$('.cfp-parent-wrapper').css("opacity","0");

},
success: function (data)
{


form_curr_html = $('.sb_cfp').html();
$('.cfp_loader').css("display","none"); 

// return false;
var shop=Shopify.shop;
var redirectpage="{{redirect_page}}";


$('#cfpmodal .cfp_field ,#cfpmodal textarea').val(' ');
$('#cfpmodal .cfp-modal-body').before(`<div class="alert alert-success" style="background-color: #dff7df;padding: 10px;">${success_message}</div>`);

if(Shopify.shop=="amtrac-furnishings.myshopify.com")  { $(".sb_cfp").html('<div class="cfp_thankyou_msg"><div class="">Thank you for your interest.</div><div class="">We will be in contact with you within 24 hours.</div></div>'); }

$('.cfp-parent-wrapper').css("opacity","1");
//                   $('#cfpname').val('');
//                   $('#cfpphone').val('');
//                    $('#cfpmessage').val('');
//                   $('#cfpphone').val(''); 
$('.sb_cfp input[type=text]').val('');
// return false;
setTimeout(function(){
$('#cfpmodal .alert-success').remove();
$('#cfpmodal').hide();



if(Shopify.shop=="amtrac-furnishings.myshopify.com")  { $(".sb_cfp").html(form_curr_html ); }


var shop=Shopify.shop;
var is_redirect="{{is_redirect}}";
var redirect_page="{{redirect_page}}";
if(is_redirect=="1"){

redirect_page=redirect_page.trim();


if(redirect_page.length==0)
{


return false;
}

window.open(redirect_page,"_self"); 
}
},hide_cfp_modal_sec);

},

error: function (error)         {

}

});
}else{
return false;
} 
});

}

  
  
  
  }
</script>
{% endif %}  





{% if shop.permanent_domain == "encorecabinetsdesign.myshopify.com" %}
{% render 'element_picker' %}
{% else %}
{% include 'element_picker' %}
{% endif %}
